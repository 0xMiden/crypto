<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A deterministic Falcon512 Poseidon2 signature over a message."><title>miden_crypto::dsa::falcon512_poseidon2 - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-b7b9f40b.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="miden_crypto" data-themes="" data-resource-suffix="" data-rustdoc-version="1.95.0-nightly (db3e99bba 2026-02-04)" data-channel="nightly" data-search-js="search-fb33671b.js" data-stringdex-js="stringdex-b897f86f.js" data-settings-js="settings-170eb4bf.js" ><script src="../../../static.files/storage-f9617a14.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-12f88f4f.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-f7c3ffd8.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><a class="skip-main-content" href="#main-content">Skip to main content</a><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module falcon512_poseidon2</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../miden_crypto/index.html">miden_<wbr>crypto</a><span class="version">0.23.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module falcon512_<wbr>poseidon2</a></h2><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#constants" title="Constants">Constants</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In miden_<wbr>crypto::<wbr>dsa</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content" tabindex="-1"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">miden_crypto</a>::<wbr><a href="../index.html">dsa</a></div><h1>Module <span>falcon512_<wbr>poseidon2</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/miden_crypto/dsa/falcon512_poseidon2/mod.rs.html#1-199">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A deterministic Falcon512 Poseidon2 signature over a message.</p>
<p>This version differs from the reference implementation in its use of the Poseidon2 algebraic
hash function in its hash-to-point algorithm.</p>
<p>Another point of difference is the determinism in the signing process. The approach used to
achieve this is the one proposed in <a href="https://github.com/algorand/falcon/blob/main/falcon-det.pdf">1</a>.
The main challenge in making the signing procedure deterministic is ensuring that the same
secret key is never used to produce two inequivalent signatures for the same <code>c</code>.
For a precise definition of equivalence of signatures see <a href="https://github.com/algorand/falcon/blob/main/falcon-det.pdf">1</a>.
The reference implementation uses a random nonce per signature in order to make sure that,
with overwhelming probability, no two c-s will ever repeat and this non-repetition turns out
to be enough to make the security proof of the underlying construction go through in
the random-oracle model.</p>
<p>Making the signing process deterministic means that we cannot rely on the above use of nonce
in the hash-to-point algorithm, i.e., the hash-to-point algorithm is deterministic. It also
means that we have to derandomize the trapdoor sampling process and use the entropy in
the secret key, together with the message, as the seed of a CPRNG. This is exactly the approach
taken in <a href="https://datatracker.ietf.org/doc/html/rfc6979#section-3.5">2</a> but, as explained at length in <a href="https://github.com/algorand/falcon/blob/main/falcon-det.pdf">1</a>, this is not enough. The reason for this
is that the sampling process during signature generation must be ensured to be consistent
across the entire computing stack i.e., hardware, compiler, OS, sampler implementations …</p>
<p>This is made even more difficult by the extensive use of floating-point arithmetic by
the sampler. In relation to this point, the current implementation does not use any platform
specific optimizations (e.g., AVX2, NEON, FMA …) and relies solely on the builtin <code>f64</code> type.
Moreover, as per the time of this writing, the implementation does not use any methods or
functions from <code>std::f64</code> that have non-deterministic precision mentioned in their
documentation.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.Nonce.html" title="struct miden_crypto::dsa::falcon512_poseidon2::Nonce">Nonce</a></dt><dd>Nonce of the Falcon signature.</dd><dt><a class="struct" href="struct.Polynomial.html" title="struct miden_crypto::dsa::falcon512_poseidon2::Polynomial">Polynomial</a></dt><dd>Represents a polynomial with coefficients of type F.</dd><dt><a class="struct" href="struct.PublicKey.html" title="struct miden_crypto::dsa::falcon512_poseidon2::PublicKey">Public<wbr>Key</a></dt><dd>Public key represented as a polynomial with coefficients over the Falcon prime field.</dd><dt><a class="struct" href="struct.SecretKey.html" title="struct miden_crypto::dsa::falcon512_poseidon2::SecretKey">Secret<wbr>Key</a></dt><dd>Represents the secret key for Falcon DSA.</dd><dt><a class="struct" href="struct.Signature.html" title="struct miden_crypto::dsa::falcon512_poseidon2::Signature">Signature</a></dt><dd>A deterministic Falcon512 Poseidon2 signature over a message.</dd><dt><a class="struct" href="struct.SignatureHeader.html" title="struct miden_crypto::dsa::falcon512_poseidon2::SignatureHeader">Signature<wbr>Header</a></dt><dd>The header byte used to encode the signature metadata.</dd><dt><a class="struct" href="struct.SignaturePoly.html" title="struct miden_crypto::dsa::falcon512_poseidon2::SignaturePoly">Signature<wbr>Poly</a></dt><dd>A polynomial used as the <code>s2</code> component of the signature.</dd></dl><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><dl class="item-table"><dt><a class="constant" href="constant.PK_LEN.html" title="constant miden_crypto::dsa::falcon512_poseidon2::PK_LEN">PK_LEN</a></dt><dd>Public key length as a u8 vector.</dd><dt><a class="constant" href="constant.SK_LEN.html" title="constant miden_crypto::dsa::falcon512_poseidon2::SK_LEN">SK_LEN</a></dt><dd>Secret key length as a u8 vector.</dd></dl></section></div></main></body></html>